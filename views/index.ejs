<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>TaskFlow â€” Add Task</title>

  <!-- Materialize CSS CDN -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/css/material.css">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
</head>
<body class="grey lighten-4">

  <nav class="blue darken-2">
    <div class="nav-wrapper container">
      <a href="/" class="brand-logo">TaskFlow</a>
    </div>
  </nav>

  <main class="container" style="margin-top:40px;">
    <div class="row">
      <div class="col s12 m8 offset-m2">
        <div class="card hoverable">
          <div class="card-content">
            <span class="card-title">Add Task</span>

            <!-- server-sent errors -->
            <% if (errors && errors.length) { %>
              <div class="card-panel red lighten-4">
                <ul style="margin:0; padding-left:18px;">
                  <% errors.forEach(function(err){ %>
                    <li><%= err %></li>
                  <% }) %>
                </ul>
              </div>
            <% } %>

            <form id="addTaskForm" action="/add-task" method="POST" onsubmit="return validateForm()">
              <div class="input-field">
                <input id="title" name="title" type="text" value="<%= task.title || '' %>" required>
                <label for="title">Title</label>
              </div>

              <div class="input-field">
                <textarea id="desc" name="description" class="materialize-textarea"><%= task.description || '' %></textarea>
                <label for="desc">Description</label>
              </div>

              <button class="btn waves-effect waves-light" type="submit">Add Task</button>
            </form>

          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- Materialize JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>

  <script>
    // Simple client-side validation using Materialize toast
    function validateForm() {
      const title = document.getElementById('title').value.trim();
      if (title.length < 3) {
        M.toast({html: 'Title must be at least 3 characters', classes: 'red lighten-1'});
        return false;
      }
      return true;
    }

    // Initialize Materialize components
    document.addEventListener('DOMContentLoaded', function() {
      M.updateTextFields();
    });
  </script>
</body>
</html>
